# éƒ¨ç½²åæ£€æŸ¥æ¸…å•

> âš ï¸ éƒ¨ç½²åå¿…é¡»ç«‹å³å®Œæˆçš„å…³é”®ä»»åŠ¡

## ğŸ”´ ç«‹å³æ‰§è¡Œï¼ˆéƒ¨ç½²å 1 å°æ—¶å†…ï¼‰

### 1. éªŒè¯éƒ¨ç½² âœ…

```bash
# æ£€æŸ¥æ‰€æœ‰åˆçº¦æ˜¯å¦éƒ¨ç½²æˆåŠŸ
npx hardhat run scripts/monitoring/health_check.js --network sepolia
```

**æ£€æŸ¥é¡¹**:
- [ ] æ‰€æœ‰åˆçº¦åœ°å€å·²è®°å½•
- [ ] åˆçº¦åœ¨ Etherscan ä¸Šå¯è§
- [ ] åˆå§‹ä¾›åº”é‡æ­£ç¡® (1äº¿ DIAP)
- [ ] å¥–åŠ±æ± ä½™é¢æ­£ç¡® (800ä¸‡ DIAP)

---

### 2. è½¬ç§»ä»£å¸åˆ°å¤šç­¾ ğŸ”´ **æœ€é«˜ä¼˜å…ˆçº§**

```bash
# 1. ç¡®è®¤ Gnosis Safe å·²åˆ›å»º
echo $GNOSIS_SAFE_ADDRESS

# 2. æ‰§è¡Œè½¬ç§»
npx hardhat run scripts/post_deploy/transfer_to_multisig.js --network sepolia

# 3. éªŒè¯
# åœ¨ Etherscan ä¸Šæ£€æŸ¥ Safe åœ°å€ä½™é¢åº”è¯¥æ˜¯ 92,000,000 DIAP
```

**è½¬ç§»æ¸…å•**:
- [ ] ç¤¾åŒºä»½é¢ (4000ä¸‡) â†’ Safe
- [ ] å›½åº“ä»½é¢ (2200ä¸‡) â†’ Safe  
- [ ] å¼€å‘è€…ä»½é¢ (1500ä¸‡) â†’ Safe
- [ ] æŠ•èµ„äººä»½é¢ (1500ä¸‡) â†’ Safe
- [ ] å¥–åŠ±æ±  (800ä¸‡) â†’ ä¿ç•™åœ¨åˆçº¦ âœ…

**éªŒè¯**:
- [ ] Safe ä½™é¢ = 92,000,000 DIAP
- [ ] åˆçº¦ä½™é¢ = 8,000,000 DIAP
- [ ] éƒ¨ç½²è€…ä½™é¢ â‰ˆ 0 DIAP

---

### 3. è½¬ç§»åˆçº¦æ‰€æœ‰æƒ ğŸ”´ **æœ€é«˜ä¼˜å…ˆçº§**

```bash
# è½¬ç§»æ‰€æœ‰åˆçº¦æ‰€æœ‰æƒåˆ° Safe
npx hardhat run scripts/post_deploy/transfer_ownership.js --network sepolia
```

**æ‰€æœ‰æƒè½¬ç§»æ¸…å•**:
- [ ] DIAPToken â†’ Safe
- [ ] DIAPAgentNetwork â†’ Safe
- [ ] DIAPPaymentCore â†’ Safe
- [ ] DIAPPaymentChannel â†’ Safe
- [ ] DIAPGovernance â†’ Safe
- [ ] DIAPVerification â†’ Safe

**éªŒè¯**:
```bash
# åœ¨ Etherscan ä¸Šæ£€æŸ¥æ¯ä¸ªåˆçº¦çš„ owner() å‡½æ•°
# åº”è¯¥è¿”å› Safe åœ°å€
```

---

### 4. æ›´æ–°é…ç½®æ–‡ä»¶

```bash
# æ›´æ–° emergency/contract_addresses.txt
# å¡«å†™æ‰€æœ‰åˆçº¦åœ°å€å’Œäº¤æ˜“å“ˆå¸Œ
```

**æ›´æ–°æ¸…å•**:
- [ ] `emergency/contract_addresses.txt` - æ‰€æœ‰åœ°å€
- [ ] `emergency/emergency_contacts.txt` - è”ç³»äºº
- [ ] `.env` - æ‰€æœ‰ç¯å¢ƒå˜é‡
- [ ] README.md - éƒ¨ç½²ä¿¡æ¯

---

### 5. é…ç½®ç›‘æ§

```bash
# 1. è®¾ç½® Tenderly
# è®¿é—® https://dashboard.tenderly.co
# æ·»åŠ æ‰€æœ‰åˆçº¦åœ°å€

# 2. æµ‹è¯• Telegram Bot
node scripts/monitoring/telegram_alert.js

# 3. è¿è¡Œé¦–æ¬¡å¥åº·æ£€æŸ¥
npm run health
```

**ç›‘æ§æ¸…å•**:
- [ ] Tenderly å·²æ·»åŠ æ‰€æœ‰åˆçº¦
- [ ] Telegram Bot å·¥ä½œæ­£å¸¸
- [ ] å¥åº·æ£€æŸ¥è„šæœ¬è¿è¡ŒæˆåŠŸ
- [ ] å‘Šè­¦è§„åˆ™å·²è®¾ç½®

---

## ğŸŸ¡ 24å°æ—¶å†…å®Œæˆ

### 6. åœ¨ Etherscan ä¸ŠéªŒè¯åˆçº¦

```bash
# éªŒè¯æ‰€æœ‰åˆçº¦æºä»£ç 
npx hardhat verify --network sepolia <CONTRACT_ADDRESS> <CONSTRUCTOR_ARGS>
```

**éªŒè¯æ¸…å•**:
- [ ] DIAPToken
- [ ] DIAPAgentNetwork
- [ ] DIAPPaymentCore
- [ ] DIAPPaymentChannel
- [ ] DIAPGovernance
- [ ] DIAPVerification

---

### 7. æµ‹è¯•å¤šç­¾æ“ä½œ

```bash
# åœ¨ Gnosis Safe UI ä¸­æµ‹è¯•
# https://app.safe.global
```

**æµ‹è¯•æ¸…å•**:
- [ ] åˆ›å»ºæµ‹è¯•äº¤æ˜“
- [ ] å¤šä¸ªæ‰€æœ‰è€…ç­¾å
- [ ] æ‰§è¡Œäº¤æ˜“
- [ ] æµ‹è¯•ç´§æ€¥æš‚åœï¼ˆåœ¨æµ‹è¯•ç½‘ï¼‰

---

### 8. è®¾ç½®è‡ªåŠ¨åŒ–ç›‘æ§

```bash
# é…ç½® GitHub Actions
# è§ .github/workflows/health_check.yml
```

**è‡ªåŠ¨åŒ–æ¸…å•**:
- [ ] GitHub Actions é…ç½®
- [ ] å®šæ—¶å¥åº·æ£€æŸ¥ (æ¯5åˆ†é’Ÿ)
- [ ] å‘Šè­¦é€šçŸ¥åˆ° Telegram
- [ ] æ—¥å¿—è®°å½•

---

### 9. å‡†å¤‡é€šä¿¡

**ç¤¾åŒºé€šä¿¡**:
- [ ] å‡†å¤‡éƒ¨ç½²å…¬å‘Š
- [ ] åˆ›å»º Discord/Telegram ç¾¤ç»„
- [ ] å‘å¸ƒåˆçº¦åœ°å€
- [ ] è¯´æ˜å¦‚ä½•ä½¿ç”¨

**æ–‡æ¡£æ›´æ–°**:
- [ ] æ›´æ–° README
- [ ] åˆ›å»ºç”¨æˆ·æŒ‡å—
- [ ] å‡†å¤‡ FAQ
- [ ] è®°å½•å·²çŸ¥é—®é¢˜

---

## ğŸŸ¢ ä¸€å‘¨å†…å®Œæˆ

### 10. å®‰å…¨æªæ–½

**å¤‡ä»½**:
- [ ] å¤‡ä»½æ‰€æœ‰ç§é’¥ï¼ˆå¤šä¸ªä½ç½®ï¼‰
- [ ] å¤‡ä»½åŠ©è®°è¯ï¼ˆçº¸è´¨+é‡‘å±æ¿ï¼‰
- [ ] å¤‡ä»½åˆçº¦åœ°å€åˆ—è¡¨
- [ ] å¤‡ä»½éƒ¨ç½²è®°å½•

**æµ‹è¯•**:
- [ ] æµ‹è¯•ç´§æ€¥æš‚åœæµç¨‹
- [ ] æµ‹è¯•ç´§æ€¥æ¢å¤æµç¨‹
- [ ] æµ‹è¯•å¤šç­¾æ“ä½œ
- [ ] è¿›è¡Œç¾éš¾æ¢å¤æ¼”ç»ƒ

---

### 11. ç¤¾åŒºå»ºè®¾

**å¯åŠ¨ç¤¾åŒº**:
- [ ] å‘å¸ƒå…¬å‘Š
- [ ] é‚€è¯·æ—©æœŸç”¨æˆ·
- [ ] æ”¶é›†åé¦ˆ
- [ ] å»ºç«‹æ”¯æŒæ¸ é“

**ç›‘æ§æŒ‡æ ‡**:
- [ ] ç”¨æˆ·æ•°é‡
- [ ] äº¤æ˜“é‡
- [ ] è´¨æŠ¼ç‡
- [ ] Gas æ¶ˆè€—

---

### 12. ä¼˜åŒ–å’Œæ”¹è¿›

**æ•°æ®æ”¶é›†**:
- [ ] ç”¨æˆ·è¡Œä¸ºåˆ†æ
- [ ] Gas ä½¿ç”¨åˆ†æ
- [ ] é”™è¯¯æ—¥å¿—åˆ†æ
- [ ] æ€§èƒ½ç›‘æ§

**ä¼˜åŒ–è®¡åˆ’**:
- [ ] è¯†åˆ«ä¼˜åŒ–æœºä¼š
- [ ] å‡†å¤‡å‡çº§æ–¹æ¡ˆ
- [ ] æµ‹è¯•ä¼˜åŒ–æ•ˆæœ
- [ ] éƒ¨ç½²ä¼˜åŒ–

---

## ğŸ“‹ éªŒè¯è„šæœ¬

åˆ›å»ºä¸€ä¸ªéªŒè¯è„šæœ¬æ¥æ£€æŸ¥æ‰€æœ‰é¡¹ç›®ï¼š

```javascript
// scripts/post_deploy/verify_deployment.js
async function main() {
    console.log("ğŸ” éªŒè¯éƒ¨ç½²...\n");
    
    const checks = [];
    
    // 1. æ£€æŸ¥åˆçº¦éƒ¨ç½²
    console.log("1ï¸âƒ£ æ£€æŸ¥åˆçº¦éƒ¨ç½²...");
    // ... æ£€æŸ¥é€»è¾‘
    
    // 2. æ£€æŸ¥ä»£å¸åˆ†é…
    console.log("2ï¸âƒ£ æ£€æŸ¥ä»£å¸åˆ†é…...");
    // ... æ£€æŸ¥é€»è¾‘
    
    // 3. æ£€æŸ¥æ‰€æœ‰æƒ
    console.log("3ï¸âƒ£ æ£€æŸ¥æ‰€æœ‰æƒ...");
    // ... æ£€æŸ¥é€»è¾‘
    
    // 4. æ£€æŸ¥ç›‘æ§
    console.log("4ï¸âƒ£ æ£€æŸ¥ç›‘æ§...");
    // ... æ£€æŸ¥é€»è¾‘
    
    // ç”ŸæˆæŠ¥å‘Š
    console.log("\n" + "=".repeat(60));
    console.log("éªŒè¯æŠ¥å‘Š");
    console.log("=".repeat(60));
    
    const passed = checks.filter(c => c.status === "passed").length;
    const failed = checks.filter(c => c.status === "failed").length;
    
    console.log(`\nâœ… é€šè¿‡: ${passed}/${checks.length}`);
    console.log(`âŒ å¤±è´¥: ${failed}/${checks.length}`);
    
    if (failed === 0) {
        console.log("\nğŸ‰ æ‰€æœ‰æ£€æŸ¥é€šè¿‡ï¼éƒ¨ç½²æˆåŠŸï¼");
    } else {
        console.log("\nâš ï¸  æœ‰æ£€æŸ¥é¡¹æœªé€šè¿‡ï¼Œè¯·ä¿®å¤åå†ç»§ç»­");
    }
}
```

---

## âš ï¸ å¸¸è§é—®é¢˜

### Q: å¦‚æœè½¬ç§»ä»£å¸æ—¶ Gas ä¸è¶³æ€ä¹ˆåŠï¼Ÿ

A: 
```bash
# 1. æ£€æŸ¥è´¦æˆ·ä½™é¢
# 2. åˆ†æ‰¹è½¬ç§»
# 3. åœ¨ Gas ä»·æ ¼ä½æ—¶æ“ä½œ
```

### Q: å¦‚æœå¤šç­¾æ“ä½œå¤±è´¥æ€ä¹ˆåŠï¼Ÿ

A:
```bash
# 1. æ£€æŸ¥æ‰€æœ‰è€…åœ°å€
# 2. ç¡®è®¤é˜ˆå€¼è®¾ç½®
# 3. é‡æ–°åˆ›å»ºäº¤æ˜“
# 4. è”ç³» Gnosis Safe æ”¯æŒ
```

### Q: å¦‚æœå‘ç°é—®é¢˜éœ€è¦å›æ»šæ€ä¹ˆåŠï¼Ÿ

A:
```bash
# 1. ç«‹å³æš‚åœåˆçº¦
npm run pause -- --network sepolia

# 2. è¯„ä¼°é—®é¢˜ä¸¥é‡æ€§
# 3. å‡†å¤‡ä¿®å¤æ–¹æ¡ˆ
# 4. é€šçŸ¥ç”¨æˆ·
```

---

## ğŸ“ ç´§æ€¥è”ç³»

å¦‚æœé‡åˆ°é—®é¢˜ï¼š

1. **æŸ¥çœ‹æ–‡æ¡£**: `docs/OPERATIONS_GUIDE.md`
2. **è¿è¡Œè¯Šæ–­**: `npm run health`
3. **æŸ¥çœ‹æ—¥å¿—**: `logs/`
4. **è”ç³»æ”¯æŒ**: è§ `emergency/emergency_contacts.txt`

---

## âœ… å®Œæˆç¡®è®¤

éƒ¨ç½²å®Œæˆåï¼Œè¯·ç¡®è®¤ï¼š

- [ ] æ‰€æœ‰ä»£å¸å·²è½¬ç§»åˆ°å¤šç­¾
- [ ] æ‰€æœ‰åˆçº¦æ‰€æœ‰æƒå·²è½¬ç§»
- [ ] ç›‘æ§ç³»ç»Ÿæ­£å¸¸è¿è¡Œ
- [ ] æ–‡æ¡£å·²æ›´æ–°
- [ ] å›¢é˜Ÿå·²é€šçŸ¥
- [ ] ç¤¾åŒºå·²é€šçŸ¥
- [ ] å¤‡ä»½å·²å®Œæˆ

**ç­¾å**: _______________  
**æ—¥æœŸ**: _______________  
**ç½‘ç»œ**: Sepolia / Mainnet

---

**è®°ä½**: å®‰å…¨ç¬¬ä¸€ï¼Œä¸è¦ç€æ€¥ã€‚æ¯ä¸€æ­¥éƒ½è¦ä»”ç»†éªŒè¯ã€‚

ğŸ¯ ç›®æ ‡ï¼šé›¶äº‹æ•…éƒ¨ç½²ï¼
